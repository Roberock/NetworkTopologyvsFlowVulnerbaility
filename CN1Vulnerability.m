function Out=CN1Vulnerability(B,Nlinks,From_Node,To_Node)


OutSpecVul_nodamag=SpectrVulnMet(B);%no damaged reference metrics
% Compute the grid vulnerability for the N-1 line contingencies
 [Rho,AlgCon,Rg,NatCon]=deal(zeros(1,Nlinks));
for i=1:Nlinks;
    %restore the network undamaged configuration
    B_dam=B; 
    % deterinistic attack of the ith line in the network
    B_dam(From_Node(i),To_Node(i))=0;
    B_dam(To_Node(i),From_Node(i))=0; 
    %compute spectral proprieties of the graph
    OutSpecVul_CN1=SpectrVulnMet(B_dam);%obtain spectral propriety
    % relative vulnerability and save
    Vul=RelSpectrVuln(OutSpecVul_nodamag,OutSpecVul_CN1);
    AlgCon(i)=Vul.AlgebraicConnectivity; Rg(i)=Vul.EffectiveResistance; NatCon(i)=Vul.NaturalConnectivity; Rho(i)=Vul.SpectralRadius;
end
Out.AlgConN1=AlgCon;
Out.RgN1=Rg;
Out.NatConN1=NatCon;
Out.RhoN1=Rho;
end